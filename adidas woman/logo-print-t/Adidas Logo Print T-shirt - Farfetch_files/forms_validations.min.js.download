!function(l){l.extend(l.fn,{validate:function(t){if(this.length){var i=l.data(this[0],"validator");return i||(this.attr("novalidate","novalidate"),i=new l.validator(t,this[0]),l.data(this[0],"validator",i),i.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){i.settings.submitHandler&&(i.submitButton=t.target),l(t.target).hasClass("cancel")&&(i.cancelSubmit=!0),void 0!==l(t.target).attr("formnovalidate")&&(i.cancelSubmit=!0)}),this.submit(function(e){function t(){var t;return!i.settings.submitHandler||(i.submitButton&&(t=l("<input type='hidden'/>").attr("name",i.submitButton.name).val(l(i.submitButton).val()).appendTo(i.currentForm)),i.settings.submitHandler.call(i,i.currentForm,e),i.submitButton&&t.remove(),!1)}return i.settings.debug&&e.preventDefault(),i.cancelSubmit?(i.cancelSubmit=!1,t()):i.form()?i.pendingRequest?!(i.formSubmitted=!0):t():(i.focusInvalid(),!1)})),i)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){if(l(this[0]).is("form"))return this.validate().form();var t=!0,e=l(this[0].form).validate();return this.each(function(){t=t&&e.element(this)}),t},removeAttrs:function(t){var i={},r=this;return l.each(t.split(/\s/),function(t,e){i[e]=r.attr(e),r.removeAttr(e)}),i},rules:function(t,e){var i=this[0];if(t){var r=l.data(i.form,"validator").settings,s=r.rules,n=l.validator.staticRules(i);switch(t){case"add":l.extend(n,l.validator.normalizeRule(e)),delete n.messages,s[i.name]=n,e.messages&&(r.messages[i.name]=l.extend(r.messages[i.name],e.messages));break;case"remove":if(!e)return delete s[i.name],n;var a={};return l.each(e.split(/\s/),function(t,e){a[e]=n[e],delete n[e]}),a}}var o=l.validator.normalizeRules(l.extend({},l.validator.classRules(i),l.validator.attributeRules(i),l.validator.dataRules(i),l.validator.staticRules(i)),i);if(o.required){var u=o.required;delete o.required,o=l.extend({required:u},o)}return o}}),l.extend(l.expr[":"],{blank:function(t){return!l.trim(""+l(t).val())},filled:function(t){return!!l.trim(""+l(t).val())},unchecked:function(t){return!l(t).prop("checked")}}),l.validator=function(t,e){this.settings=l.extend(!0,{},l.validator.defaults,t),this.currentForm=e,this.init()},l.validator.getTranslation=function(t){return FFAPI&&FFAPI.translations&&FFAPI.translations[t]?FFAPI.translations[t]:"*"},l.validator.format=function(i,t){return 1===arguments.length?function(){var t=l.makeArray(arguments);return t.unshift(i),l.validator.format.apply(this,t)}:(2<arguments.length&&t.constructor!==Array&&(t=l.makeArray(arguments).slice(1)),t.constructor!==Array&&(t=[t]),l.each(t,function(t,e){i=i.replace(new RegExp("\\{"+t+"\\}","g"),function(){return e})}),i)},l.extend(l.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"span",focusInvalid:!0,errorContainer:l([]),errorLabelContainer:l([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(t,e){this.lastActive=t,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,t,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(t)).hide())},onfocusout:function(t,e){this.checkable(t)||!(t.name in this.submitted)&&this.optional(t)||this.element(t)},onkeyup:function(t,e){9===e.which&&""===this.elementValue(t)||(t.name in this.submitted||t===this.lastElement)&&this.element(t)},onclick:function(t,e){t.name in this.submitted?this.element(t):t.parentNode.name in this.submitted&&this.element(t.parentNode)},highlight:function(t,e,i){"radio"===t.type?this.findByName(t.name).addClass(e).removeClass(i):l(t).addClass(e).removeClass(i)},unhighlight:function(t,e,i){"radio"===t.type?this.findByName(t.name).removeClass(e).addClass(i):l(t).removeClass(e).addClass(i)}},setDefaults:function(t){l.extend(l.validator.defaults,t)},messages:{required:l.validator.getTranslation("requiredErrorMsg"),remote:l.validator.getTranslation("remoteErrorMsg"),email:l.validator.getTranslation("emailErrorMsg"),url:l.validator.getTranslation("urlErrorMsg"),date:l.validator.getTranslation("dateErrorMsg"),dateISO:l.validator.getTranslation("dateISOErrorMsg"),number:l.validator.getTranslation("numberErrorMsg"),digits:l.validator.getTranslation("digitsErrorMsg"),creditcard:l.validator.getTranslation("creditcardErrorMsg"),equalTo:l.validator.getTranslation("equalToErrorMsg"),maxlength:l.validator.format(l.validator.getTranslation("numCharactersErrorMsg")),minlength:l.validator.format(l.validator.getTranslation("minlengthErrorMsg")),rangelength:l.validator.format(l.validator.getTranslation("rangelengthErrorMsg")),range:l.validator.format(l.validator.getTranslation("rangeErrorMsg")),max:l.validator.format(l.validator.getTranslation("maxErrorMsg")),min:l.validator.format(l.validator.getTranslation("minErrorMsg"))},autoCreateRanges:!1,prototype:{init:function(){this.labelContainer=l(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||l(this.currentForm),this.containers=l(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var r=this.groups={};l.each(this.settings.groups,function(i,t){"string"==typeof t&&(t=t.split(/\s/)),l.each(t,function(t,e){r[e]=i})});var i=this.settings.rules;function t(t){var e=l.data(this[0].form,"validator"),i="on"+t.type.replace(/^validate/,"");e.settings[i]&&e.settings[i].call(e,this[0],t)}l.each(i,function(t,e){i[t]=l.validator.normalizeRule(e)}),l(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",t).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",t),this.settings.invalidHandler&&l(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),l.extend(this.submitted,this.errorMap),this.invalid=l.extend({},this.errorMap),this.valid()||l(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var t=0,e=this.currentElements=this.elements();e[t];t++)this.check(e[t]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=l(t);var e=!1!==this.check(t);return e?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),e},showErrors:function(e){if(e){for(var t in l.extend(this.errorMap,e),this.errorList=[],e)this.errorList.push({message:e[t],element:this.findByName(t)[0]});this.successList=l.grep(this.successList,function(t){return!(t.name in e)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){l.fn.resetForm&&l(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(t){var e=0;for(var i in t)e++;return e},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{l(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var e=this.lastActive;return e&&1===l.grep(this.errorList,function(t){return t.element.name===e.name}).length&&e},elements:function(){var t=this,e={};return l(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),!(this.name in e||!t.objectLength(l(this).rules()))&&(e[this.name]=!0)})},clean:function(t){return l(t)[0]},errors:function(){var t=this.settings.errorClass.replace(" ",".");return l(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=l([]),this.toHide=l([]),this.currentElements=l([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(t){this.reset(),this.toHide=this.errorsFor(t)},elementValue:function(t){var e=l(t).attr("type"),i=l(t).val();return"radio"===e||"checkbox"===e?l("input[name='"+l(t).attr("name")+"']:checked").val():"string"==typeof i?i.replace(/\r/g,""):i},check:function(e){e=this.validationTargetFor(this.clean(e));var t,i=l(e).rules(),r=!1,s=this.elementValue(e);for(var n in i){var a={method:n,parameters:i[n]};try{if("dependency-mismatch"===(t=l.validator.methods[n].call(this,s,e,a.parameters))){r=!0;continue}if(r=!1,"pending"===t)return void(this.toHide=this.toHide.not(this.errorsFor(e)));if(!t)return this.formatAndAdd(e,a),!1}catch(t){throw this.settings.debug&&window.console&&e.id,t}}if(!r)return this.objectLength(i)&&this.successList.push(e),!0},customDataMessage:function(t,e){return l(t).data("msg-"+e.toLowerCase())||t.attributes&&l(t).attr("data-msg-"+e.toLowerCase())},customMessage:function(t,e){var i=this.settings.messages[t];return i&&(i.constructor===String?i:i[e])},findDefined:function(){for(var t=0;t<arguments.length;t++)if(void 0!==arguments[t])return arguments[t]},defaultMessage:function(t,e){return this.findDefined(this.customMessage(t.name,e),this.customDataMessage(t,e),!this.settings.ignoreTitle&&t.title||void 0,l.validator.messages[e],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,e){var i=this.defaultMessage(t,e.method),r=/\$?\{(\d+)\}/g;"function"==typeof i?i=i.call(this,e.parameters,t):r.test(i)&&(i=l.validator.format(i.replace(r,"{$1}"),e.parameters)),this.errorList.push({message:i,element:t}),this.errorMap[t.name]=i,this.submitted[t.name]=i},addWrapper:function(t){return this.settings.wrapper&&(t=t.add(t.parent(this.settings.wrapper))),t},defaultShowErrors:function(){var t,e;for(t=0;this.errorList[t];t++){var i=this.errorList[t];this.settings.highlight&&this.settings.highlight.call(this,i.element,this.settings.errorClass,this.settings.validClass),this.showLabel(i.element,i.message)}if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(t=0;this.successList[t];t++)this.showLabel(this.successList[t]);if(this.settings.unhighlight)for(t=0,e=this.validElements();e[t];t++)this.settings.unhighlight.call(this,e[t],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return l(this.errorList).map(function(){return this.element})},showLabel:function(t,e){var i=this.errorsFor(t);i.length?(i.removeClass(this.settings.validClass).addClass(this.settings.errorClass),i.html(e)):(i=l("<"+this.settings.errorElement+">").attr("for",this.idOrName(t)).addClass(this.settings.errorClass).html(e||""),this.settings.wrapper&&(i=i.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(i).length||(this.settings.errorPlacement?this.settings.errorPlacement(i,l(t)):i.insertAfter(t))),!e&&this.settings.success&&(i.text(""),"string"==typeof this.settings.success?i.addClass(this.settings.success):this.settings.success(i,t)),this.toShow=this.toShow.add(i)},errorsFor:function(t){var e=this.idOrName(t);return this.errors().filter(function(){return l(this).attr("for")===e})},idOrName:function(t){return this.groups[t.name]||(this.checkable(t)?t.name:t.id||t.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name).not(this.settings.ignore)[0]),t},checkable:function(t){return/radio|checkbox/i.test(t.type)},findByName:function(t){return l(this.currentForm).find("[name='"+t+"']")},getLength:function(t,e){switch(e.nodeName.toLowerCase()){case"select":return l("option:selected",e).length;case"input":if(this.checkable(e))return this.findByName(e.name).filter(":checked").length}return t.length},depend:function(t,e){return!this.dependTypes[typeof t]||this.dependTypes[typeof t](t,e)},dependTypes:{boolean:function(t,e){return t},string:function(t,e){return!!l(t,e.form).length},function:function(t,e){return t(e)}},optional:function(t){var e=this.elementValue(t);return!l.validator.methods.required.call(this,e,t)&&"dependency-mismatch"},startRequest:function(t){this.pending[t.name]||(this.pendingRequest++,this.pending[t.name]=!0)},stopRequest:function(t,e){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],e&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(l(this.currentForm).submit(),this.formSubmitted=!1):!e&&0===this.pendingRequest&&this.formSubmitted&&(l(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return l.data(t,"previousValue")||l.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,e){t.constructor===String?this.classRuleSettings[t]=e:l.extend(this.classRuleSettings,t)},classRules:function(t){var e={},i=l(t).attr("class");return i&&l.each(i.split(" "),function(){this in l.validator.classRuleSettings&&l.extend(e,l.validator.classRuleSettings[this])}),e},attributeRules:function(t){var e={},i=l(t),r=i[0].getAttribute("type");for(var s in l.validator.methods){var n;n="required"===s?(""===(n=i.get(0).getAttribute(s))&&(n=!0),!!n):i.attr(s),/min|max/.test(s)&&(null===r||/number|range|text/.test(r))&&(n=Number(n)),n?e[s]=n:r===s&&"range"!==r&&(e[s]=!0)}return e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)&&delete e.maxlength,e},dataRules:function(t){var e,i,r={},s=l(t);for(e in l.validator.methods)void 0!==(i=s.data("rule-"+e.toLowerCase()))&&(r[e]=i);return r},staticRules:function(t){var e={},i=l.data(t.form,"validator");return i.settings.rules&&(e=l.validator.normalizeRule(i.settings.rules[t.name])||{}),e},normalizeRules:function(r,s){return l.each(r,function(t,e){if(!1!==e){if(e.param||e.depends){var i=!0;switch(typeof e.depends){case"string":i=!!l(e.depends,s.form).length;break;case"function":i=e.depends.call(s,s)}i?r[t]=void 0===e.param||e.param:delete r[t]}}else delete r[t]}),l.each(r,function(t,e){r[t]=l.isFunction(e)?e(s):e}),l.each(["minlength","maxlength"],function(){r[this]&&(r[this]=Number(r[this]))}),l.each(["rangelength","range"],function(){var t;r[this]&&(l.isArray(r[this])?r[this]=[Number(r[this][0]),Number(r[this][1])]:"string"==typeof r[this]&&(t=r[this].split(/[\s,]+/),r[this]=[Number(t[0]),Number(t[1])]))}),l.validator.autoCreateRanges&&(r.min&&r.max&&(r.range=[r.min,r.max],delete r.min,delete r.max),r.minlength&&r.maxlength&&(r.rangelength=[r.minlength,r.maxlength],delete r.minlength,delete r.maxlength)),r},normalizeRule:function(t){if("string"==typeof t){var e={};l.each(t.split(/\s/),function(){e[this]=!0}),t=e}return t},addMethod:function(t,e,i){l.validator.methods[t]=e,l.validator.messages[t]=void 0!==i?i:l.validator.messages[t],e.length<3&&l.validator.addClassRules(t,l.validator.normalizeRule(t))},methods:{required:function(t,e,i){if(!this.depend(i,e))return"dependency-mismatch";if("select"!==e.nodeName.toLowerCase())return this.checkable(e)?0<this.getLength(t,e):0<l.trim(t).length;var r=l(e).val();return r&&0<r.length},email:function(t,e){return this.optional(e)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},url:function(t,e){return this.optional(e)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(t)},date:function(t,e){return this.optional(e)||!/Invalid|NaN/.test(new Date(t).toString())},dateISO:function(t,e){return this.optional(e)||/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}$/.test(t)},number:function(t,e){return this.optional(e)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(t)},digits:function(t,e){return this.optional(e)||/^\d+$/.test(t)},creditcard:function(t,e){if(this.optional(e))return"dependency-mismatch";if(/[^0-9 \-]+/.test(t))return!1;for(var i=0,r=0,s=!1,n=(t=t.replace(/\D/g,"")).length-1;0<=n;n--){var a=t.charAt(n);r=parseInt(a,10),s&&9<(r*=2)&&(r-=9),i+=r,s=!s}return i%10==0},minlength:function(t,e,i){var r=l.isArray(t)?t.length:this.getLength(l.trim(t),e);return this.optional(e)||i<=r},maxlength:function(t,e,i){var r=l.isArray(t)?t.length:this.getLength(l.trim(t),e);return this.optional(e)||r<=i},rangelength:function(t,e,i){var r=l.isArray(t)?t.length:this.getLength(l.trim(t),e);return this.optional(e)||r>=i[0]&&r<=i[1]},min:function(t,e,i){return this.optional(e)||i<=t},max:function(t,e,i){return this.optional(e)||t<=i},range:function(t,e,i){return this.optional(e)||t>=i[0]&&t<=i[1]},equalTo:function(t,e,i){var r=l(i);return this.settings.onfocusout&&r.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){l(e).valid()}),t===r.val()},remote:function(n,a,t){if(this.optional(a))return"dependency-mismatch";var o=this.previousValue(a);if(this.settings.messages[a.name]||(this.settings.messages[a.name]={}),o.originalMessage=this.settings.messages[a.name].remote,this.settings.messages[a.name].remote=o.message,t="string"==typeof t&&{url:t}||t,o.old===n)return o.valid;o.old=n;var u=this;this.startRequest(a);var e={};return e[a.name]=n,l.ajax(l.extend(!0,{url:t,mode:"abort",port:"validate"+a.name,dataType:"json",data:e,success:function(t){u.settings.messages[a.name].remote=o.originalMessage;var e=!0===t||"true"===t;if(e){var i=u.formSubmitted;u.prepareElement(a),u.formSubmitted=i,u.successList.push(a),delete u.invalid[a.name],u.showErrors()}else{var r={},s=t||u.defaultMessage(a,"remote");r[a.name]=o.message=l.isFunction(s)?s(n):s,u.invalid[a.name]=!0,u.showErrors(r)}o.valid=e,u.stopRequest(a,e)}},t)),"pending"}}}),l.format=l.validator.format}(jQuery),function(r){var s={};if(r.ajaxPrefilter)r.ajaxPrefilter(function(t,e,i){var r=t.port;"abort"===t.mode&&(s[r]&&s[r].abort(),s[r]=i)});else{var n=r.ajax;r.ajax=function(t){var e=("mode"in t?t:r.ajaxSettings).mode,i=("port"in t?t:r.ajaxSettings).port;return"abort"===e?(s[i]&&s[i].abort(),s[i]=n.apply(this,arguments),s[i]):n.apply(this,arguments)}}}(jQuery),function(s){s.extend(s.fn,{validateDelegate:function(i,t,r){return this.bind(t,function(t){var e=s(t.target);if(e.is(i))return r.apply(e,arguments)})}})}(jQuery);
!function(o){var i="unobtrusiveAjaxClick",r="unobtrusiveAjaxClickTarget";function d(t,a){for(var e=window,n=(t||"").split(".");e&&n.length;)e=e[n.shift()];return"function"==typeof e?e:(a.push(t),Function.constructor.apply(null,a))}function s(t){return"GET"===t||"POST"===t}function u(n,t){var a,e,r,i;if(!(a=n.getAttribute("data-ajax-confirm"))||window.confirm(a)){e=o(n.getAttribute("data-ajax-loading")),i=parseInt(n.getAttribute("data-ajax-loading-duration"),10)||0,o.extend(t,{context:n,type:n.getAttribute("data-ajax-method")||void 0,url:n.getAttribute("data-ajax-url")||void 0,beforeSend:function(t){var a;return function(t,a){s(a)||t.setRequestHeader("X-HTTP-Method-Override",a)}(t,r),!1!==(a=d(n.getAttribute("data-ajax-begin"),["xhr"]).apply(this,arguments))&&e.show(i),a},complete:function(){e.hide(i),d(n.getAttribute("data-ajax-complete"),["xhr","status"]).apply(this,arguments)},success:function(t,a,e){!function(t,n,a){var r;-1===a.indexOf("application/x-javascript")&&(r=(t.getAttribute("data-ajax-mode")||"").toUpperCase(),o(t.getAttribute("data-ajax-update")).each(function(t,a){var e;switch(r){case"BEFORE":e=a.firstChild,o("<div />").html(n).contents().each(function(){a.insertBefore(this,e)});break;case"AFTER":o("<div />").html(n).contents().each(function(){a.appendChild(this)});break;default:o(a).html(n)}}))}(n,t,e.getResponseHeader("Content-Type")||"text/html"),d(n.getAttribute("data-ajax-success"),["data","status","xhr"]).apply(this,arguments)},error:d(n.getAttribute("data-ajax-failure"),["xhr","status","error"])});var u=n.getAttribute("data-with-credentials");null==u||"true"!=u.toLowerCase()&&1!=u||o.extend(t,{xhrFields:{withCredentials:!0}}),t.data.push({name:"X-Requested-With",value:"XMLHttpRequest"}),s(r=t.type.toUpperCase())||(t.type="POST",t.data.push({name:"X-HTTP-Method-Override",value:r})),o.ajax(t)}}data_validation="unobtrusiveValidation",o(document).on("click","a[data-ajax=true]",function(t){t.preventDefault(),u(this,{url:this.href,type:"GET",data:[]})}),o(document).on("click","form[data-ajax=true] input[type=image]",function(t){var a=t.target.name,e=o(t.target),n=o(e.parents("form")[0]),r=e.offset();n.data(i,[{name:a+".x",value:Math.round(t.pageX-r.left)},{name:a+".y",value:Math.round(t.pageY-r.top)}]),setTimeout(function(){n.removeData(i)},0)}),o(document).on("click","form[data-ajax=true] :submit",function(t){var a=t.currentTarget.name,e=o(t.target),n=o(e.parents("form")[0]);n.data(i,a?[{name:a,value:t.currentTarget.value}]:[]),n.data(r,e),setTimeout(function(){n.removeData(i),n.removeData(r)},0)}),o(document).on("submit","form[data-ajax=true]",function(t){var a=o(this).data(i)||[],e=o(this).data(r),n=e&&e.hasClass("cancel");t.preventDefault(),(n||function(t){var a=o(t).data(data_validation);return!a||!a.validate||a.validate()}(this))&&u(this,{url:this.action,type:this.method||"GET",data:a.concat(o(this).serializeArray())})})}(jQuery);
!function(s){var a,n=s.validator,d="unobtrusiveValidation";function o(a,e,n){a.rules[e]=n,a.message&&(a.messages[e]=a.message)}function l(a){return a.replace(/([!"#$%&'()*+,./:;<=>?@\[\\\]^`{|}~])/g,"\\$1")}function m(a){return a.substr(0,a.lastIndexOf(".")+1)}function u(a,e){return 0===a.indexOf("*.")&&(a=a.replace("*.",e)),a}function p(a,e){var n=s(this).find("[data-valmsg-for='"+l(e[0].name)+"']"),t=n.attr("data-valmsg-replace"),i=t?!1!==s.parseJSON(t):null;n.removeClass("field-validation-valid").addClass("field-validation-error"),a.data("unobtrusiveContainer",n),i?(n.empty(),a.removeClass("input-validation-error").appendTo(n)):a.hide()}function f(a,e){var n=s(this).find("[data-valmsg-summary=true]"),t=n.find("ul");t&&t.length&&e.errorList.length&&(t.empty(),n.addClass("validation-summary-errors").removeClass("validation-summary-valid"),s.each(e.errorList,function(){s("<li />").html(this.message).appendTo(t)}))}function v(a){var e=a.data("unobtrusiveContainer"),n=e.attr("data-valmsg-replace"),t=n?s.parseJSON(n):null;e&&(e.addClass("field-validation-valid").removeClass("field-validation-error"),a.removeData("unobtrusiveContainer"),t&&e.empty())}function c(a){var e=s(this);e.data("validator").resetForm(),e.find(".validation-summary-errors").addClass("validation-summary-valid").removeClass("validation-summary-errors"),e.find(".field-validation-error").addClass("field-validation-valid").removeClass("field-validation-error").removeData("unobtrusiveContainer").find(">*").removeData("unobtrusiveContainer")}function h(a,e,n){if(s.validator.defaults[a].call(this,e,n),this.invalid[e.name]){var t=document.createEvent("CustomEvent");t.initCustomEvent("invalid-element.validate",!0,!0,this),e.dispatchEvent(t)}}function g(a){var e=s(a),n=e.data(d),t=s.proxy(c,a),i="Detail.CreditCardDetails.NewCreditCardDetails.Number",r="Detail.CreditCardDetails.NewCreditCardDetails.CCV";return n||(n={options:{errorClass:"input-validation-error",errorElement:"span",errorPlacement:s.proxy(p,a),invalidHandler:s.proxy(f,a),messages:{},rules:{},success:s.proxy(v,a),onfocusout:function(a,e){h.call(this,"onfocusout",a,e)},onkeyup:function(a,e){if(a.name===i||a.name===r)return!1;h.call(this,"onkeyup",a,e)}},attachValidation:function(){e.unbind("reset."+d,t).bind("reset."+d,t).validate(this.options)},validate:function(){return e.validate(),e.valid()}},e.data(d,n)),n}n.unobtrusive={adapters:[],parseElement:function(t,a){var e,i,r,d=s(t),o=d.parents("form")[0];o&&((e=g(o)).options.rules[t.name]=i={},e.options.messages[t.name]=r={},s.each(this.adapters,function(){var a="data-val-"+this.name,e=d.attr(a),n={};void 0!==e&&(a+="-",s.each(this.params,function(){n[this]=d.attr(a+this)}),this.adapt({element:t,form:o,message:e,params:n,rules:i,messages:r}))}),s.extend(i,{__dummy__:!0}),a||e.attachValidation())},parse:function(a){var e=s(a).parents("form").andSelf().add(s(a).find("form")).filter("form");s(a).find(":input").filter("[data-val=true]").each(function(){n.unobtrusive.parseElement(this,!0)}),e.each(function(){var a=g(this);a&&a.attachValidation()})}},(a=n.unobtrusive.adapters).add=function(a,e,n){return n||(n=e,e=[]),this.push({name:a,params:e,adapt:n}),this},a.addBool=function(e,n){return this.add(e,function(a){o(a,n||e,!0)})},a.addMinMax=function(a,t,i,r,e,n){return this.add(a,[e||"min",n||"max"],function(a){var e=a.params.min,n=a.params.max;e&&n?o(a,r,[e,n]):e?o(a,t,e):n&&o(a,i,n)})},a.addSingleVal=function(e,n,t){return this.add(e,[n||"val"],function(a){o(a,t||e,a.params[n])})},n.addMethod("__dummy__",function(a,e,n){return!0}),n.addMethod("regex",function(a,e,n){var t;return!!this.optional(e)||(t=new RegExp(n).exec(a))&&0===t.index&&t[0].length===a.length}),n.addMethod("nonalphamin",function(a,e,n){var t;return n&&(t=(t=a.match(/\W/g))&&t.length>=n),t}),n.methods.extension?(a.addSingleVal("accept","mimtype"),a.addSingleVal("extension","extension")):a.addSingleVal("extension","extension","accept"),a.addSingleVal("regex","pattern"),a.addBool("creditcard").addBool("date").addBool("digits").addBool("email").addBool("number").addBool("url"),a.addMinMax("length","minlength","maxlength","rangelength").addMinMax("range","min","max","range"),a.addMinMax("minlength","minlength").addMinMax("maxlength","minlength","maxlength"),a.add("equalto",["other"],function(a){var e=m(a.element.name),n=u(a.params.other,e);o(a,"equalTo",s(a.form).find(":input").filter("[name='"+l(n)+"']")[0])}),a.add("required",function(a){"INPUT"===a.element.tagName.toUpperCase()&&"CHECKBOX"===a.element.type.toUpperCase()||o(a,"required",!0)}),a.add("remote",["url","type","additionalfields"],function(t){var i={url:t.params.url,type:t.params.type||"GET",data:{}},r=m(t.element.name);s.each(function(a){return a.replace(/^\s+|\s+$/g,"").split(/\s*,\s*/g)}(t.params.additionalfields||t.element.name),function(a,e){var n=u(e,r);i.data[n]=function(){return s(t.form).find(":input").filter("[name='"+l(n)+"']").val()}}),o(t,"remote",i)}),a.add("password",["min","nonalphamin","regex"],function(a){a.params.min&&o(a,"minlength",a.params.min),a.params.nonalphamin&&o(a,"nonalphamin",a.params.nonalphamin),a.params.regex&&o(a,"regex",a.params.regex)})}(jQuery);
$.validator&&($.validator.addMethod("filesize",function(e,a,r){return a.files.length<1||(!a.files||!a.files[0].size||a.files[0].size<r.maxsize)}),$.validator.unobtrusive.adapters.add("filesize",["maxsize"],function(e){e.rules.filesize=e.params,e.message&&(e.messages.filesize=e.message)}),$.validator.addMethod("accept",function(e,a,r){if(a.files.length<1)return!0;if(!a.files||!a.files[0].size)return!0;var t=r.exts.split(","),s=a.files[0].name.toLowerCase(),n=s.substr(s.lastIndexOf(".")+1);return!(-1==$.inArray(n,t))}),$.validator.unobtrusive.adapters.add("accept",["exts"],function(e){e.rules.accept=e.params,e.message&&(e.messages.accept=e.message)}),$.validator.addMethod("validfullname",function(e,a,r){var t=e.match(/\b[^\s]+\b/g);return t&&2<=t.length}),$.validator.unobtrusive.adapters.add("validfullname",[""],function(e){e.messages.validfullname=e.message,e.rules.validfullname=!0}),$.validator.addMethod("validcpf",function(e,a,r){var t=e.replace(/\.|-/gi,"");if(""==t)return!1;if(11!=t.length||"00000000000"==t||"11111111111"==t||"22222222222"==t||"33333333333"==t||"44444444444"==t||"55555555555"==t||"66666666666"==t||"77777777777"==t||"88888888888"==t||"99999999999"==t)return!1;for(var s=0,n=0;n<9;n++)s+=parseInt(t.charAt(n))*(10-n);var d=11-s%11;if(10!=d&&11!=d||(d=0),d!=parseInt(t.charAt(9)))return!1;for(n=s=0;n<10;n++)s+=parseInt(t.charAt(n))*(11-n);return 10!=(d=11-s%11)&&11!=d||(d=0),d==parseInt(t.charAt(10))}),$.validator.unobtrusive.adapters.add("validcpf",[""],function(e){e.messages.validcpf=e.message,e.rules.validcpf=!0}),$.validator.addMethod("creditcardmonth",function(e,a,r){var t=void 0;try{var s=a.name.split(".");s=s[s.length-1];var n=a.name.replace(s,r);t=parseInt($('[name="'+n+'"]').val())}catch(e){}null==t&&(t=parseInt($("#"+r).val()));var d=parseInt(e);return!(!isNaN(t)&&!isNaN(d))||new Date(t,d,0)>=new Date}),$.validator.unobtrusive.adapters.add("creditcardmonth",["yearpropertyname"],function(e){e.rules.creditcardmonth=e.params.yearpropertyname,e.messages.creditcardmonth=e.message}),$.validator.addMethod("numericlessthan",function(e,a,r){var t=$(r.element).val();return isNaN(e)&&isNaN(t)||("True"===r.allowequality?parseFloat(e)<=parseFloat(t):parseFloat(e)<parseFloat(t))},""),$.validator.unobtrusive.adapters.add("numericlessthan",["other","allowequality"],function(e){other=e.params.other,element=$(e.form).find(":input[name="+other+"]")[0],e.rules.numericlessthan={allowequality:e.params.allowequality,element:element},e.message&&(e.messages.numericlessthan=e.message)}),$.validator.addMethod("requiredif",function(e,a,r){var t="#"+r.dependentproperty,s=$(a).closest("form"),n=r.targetvalue;n=(null==n?"":n).toString();var d=s.find(t),i=void 0;if("checkbox"===d.attr("type")){var o=d.prop("checked");i=null!=o&&null!=o?o:d.attr("checked")}else i=d.val();return"False"===i&&(i=i.toLowerCase()),FFAPI.methods.stringToBool(n)===FFAPI.methods.stringToBool(i)?$.validator.methods.required.call(this,e,a,r):"requiredif-ok"}),$.validator.unobtrusive.adapters.add("requiredif",["dependentproperty","targetvalue"],function(e){e.rules.requiredif={dependentproperty:e.params.dependentproperty,targetvalue:e.params.targetvalue},e.messages.requiredif=e.message}),$.validator.addMethod("enforcetrue",function(e,a,r){return a.checked}),$.validator.unobtrusive.adapters.add("enforcetrue",function(e){e.messages.enforcetrue=e.message,e.rules.enforcetrue=e.params}),$.validator.setDefaults({ignore:"input:hidden:not(.dropdownhidden, .searchableajaxdropdown, .sizeUnavailableValueForValidate, .validateCheckbox),select.dropdown-searchable,select:hidden:not(.dropdownhidden), .no-validate, .js-checkout-editcardtoken-forms:hidden select, #js-checkout-newcreditcard-form:hidden select",highlight:function(e,a,r){if("radio"===e.type)this.findByName(e.name).removeClass(r).addClass(a);else if($(e).hasClass("dropdownhidden")){var t=$(e).attr("name");0<(s=$(this.currentForm).find("div[data-input-hidden-name='"+t+"']")).length&&s.removeClass(r).addClass(a)}else if($(e).hasClass("searchableajaxdropdown")||$(e).hasClass("dropdown-searchable")){t=$(e).attr("name");var s,n=$(this.currentForm).find("span[data-valmsg-for='"+t+"']");if(0<n.length)0<(s=n.siblings("div.chosen-container")).length&&s.removeClass(r).addClass(a)}else $(e).removeClass(r).addClass(a)},unhighlight:function(e,a,r){if("radio"===e.type)this.findByName(e.name).removeClass(a).addClass(r);else if($(e).hasClass("dropdownhidden")){var t=$(e).attr("name");0<(s=$(this.currentForm).find("div[data-input-hidden-name='"+t+"']")).length&&s.removeClass(a).addClass(r)}else if($(e).hasClass("searchableajaxdropdown")||$(e).hasClass("dropdown-searchable")){t=$(e).attr("name");var s,n=$(this.currentForm).find("span[data-valmsg-for='"+t+"']");if(0<n.length)0<(s=n.siblings("div.chosen-container")).length&&s.removeClass(a).addClass(r)}$(e).data("data-val-required")||""!=$(e).val()?$(e).removeClass(a).addClass(r):$(e).removeClass(a)}}),$.validator.addMethod("zipbyselectedcountry",function(e,a,r){r.dependentproperty;var t=$(a).closest("form").find("#countryList"),s=void 0;if("checkbox"===t.attr("type")){var n=t.prop("checked");s=null!=n&&null!=n?n:t.attr("checked")}else s=t.val();if("False"===s&&(s=s.toLowerCase()),null==s){var d=document.getElementById("CountryID");s=null!=d?d.value:void 0}var i=/^[^<;!&>]+$/;return"42"==s?i=/^[0-9]{6}$/:"28"==s&&(i=/^[0-9]{5}-[0-9]{3}$/),e.match(i)==e}),$.validator.unobtrusive.adapters.add("zipbyselectedcountry",["dependentproperty","targetvalue"],function(e){e.rules.zipbyselectedcountry={dependentproperty:e.params.dependentproperty,targetvalue:e.params.targetvalue},e.messages.zipbyselectedcountry=e.message}),$.validator.addMethod("phonenumberregex",function(e,a,r){var t=this.currentForm.querySelector(".phoneNumberInputSelector .chooser-item-selected");if(window.innerWidth<480){var s=this.currentForm.querySelector(".mobilePhoneNumberDropdown");t=s.options[s.selectedIndex]}if(t){var n=t.dataset.phoneRegex;return n=n||a.dataset.valPhonenumberregexDefault,e.match(n)}return!1}),$.validator.unobtrusive.adapters.add("phonenumberregex",function(e){e.messages.phonenumberregex=e.message,e.rules.phonenumberregex=e.params}));